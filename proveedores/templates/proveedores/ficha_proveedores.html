{% extends 'base.html' %}
{% load static %}

{% block title %}Proveedores{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'usuarios/css/admin.css' %}">
<link rel="stylesheet" href="{% static 'usuarios/css/gestion_mecanicos.css' %}">
{% endblock %}

{% block body_class %}dashboard-body{% endblock %}
{% block main_class %}p-0 m-0 w-100{% endblock %}

{% block content %}

<div class="gm-wrapper">
  <div class="gm-overlay">

    <!-- Botón volver -->
    <div class="gm-back-container">
      <a href="{% url 'usuarios:dashboard' %}" class="gm-btn-back">
        ← Volver al dashboard
      </a>
    </div>

    <!-- Título -->
    <h1 class="gm-title">Proveedores</h1>
    <p class="gm-subtitle">Listado y gestión de proveedores registrados</p>

    {% include 'includes/messages.html' %}

    <!-- Botón crear -->
    {% if request.user.is_staff or request.user.is_superuser %}
    <div class="gm-top-actions">
      <a href="{% url 'proveedores:crear' %}" class="gm-btn gm-btn-orange">
        Agregar Proveedor
      </a>
    </div>
    {% endif %}

    <!-- Contador -->
    <div class="gm-counter">
      Cantidad de Proveedores: {{ proveedores|length }}
    </div>

    <!-- Tabla -->
    <div class="gm-table-wrapper">
      <table class="gm-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>RUT</th>
            <th>Teléfono</th>
            <th>Correo</th>
            <th>Dirección</th>
            {% if request.user.is_staff or request.user.is_superuser %}
            <th>Acciones</th>
            {% endif %}
          </tr>
        </thead>

        <tbody>
        {% for p in proveedores %}
          <tr>
            <td>{{ p.id }}</td>
            <td><b>{{ p.nombre }}</b></td>
            <td>{{ p.rut }}</td>
            <td><a href="tel:{{ p.telefono }}">{{ p.telefono }}</a></td>
            <td><a href="mailto:{{ p.correo }}">{{ p.correo }}</a></td>
            <td>{{ p.direccion }}</td>

            {% if request.user.is_staff or request.user.is_superuser %}
            <td class="gm-actions-cell">
              <a href="{% url 'proveedores:editar' p.id %}"
                 class="gm-btn-table gm-btn-edit">
                Editar
              </a>

              <a href="{% url 'proveedores:eliminar' p.id %}"
                 class="gm-btn-table gm-btn-delete">
                Eliminar
              </a>
            </td>
            {% endif %}
          </tr>
        {% empty %}
          <tr>
            <td colspan="7" class="gm-empty">No hay proveedores registrados.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>

{% endblock %}
